name: Add Metadata to Markdown

on:
  pull_request:
    types:
      - created

jobs:
  add_metadata:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Find and update Markdown file
        id: find_file
        run: |
          md_file=$(git diff --name-only HEAD^ HEAD | grep -E '\.md$' | head -n 1)
          if [[ -n "$md_file" ]]; then
            echo "Found Markdown file: $md_file"
            sed -i "1i <span style=\"background-color:#fff5b1\">Author : $GITHUB_ACTOR / Last Update : $(date +'%Y-%m-%d')</span>" "$md_file"
          else
            echo "No Markdown files found."
            exit 1
          fi

      - name: Commit and push changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add .
          git commit -m "Add metadata to Markdown file"
          git push
